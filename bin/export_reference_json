#!/usr/bin/env ruby

require 'dfe/reference_data'
require 'json'

env = Kernel.binding

if ARGV.empty?
  puts 'USAGE: export_reference_json <require-name>... <list-expression>'
else
  list_expression = ARGV[-1]
  require_names = ARGV[0..-2]

  require_names.each_entry do |name|
    env.eval("require '#{name}'")
  end

  puts JSON.generate(env.eval(list_expression))
end
